<!DOCTYPE html>
<html>

<head>
    <title>Make some ❤️🎨!</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <style>
    body {
      background-color: #202227;
      font-family: sans-serif;
      color: #DDD
    }
    h1 {
      font-size: 3.5em;
      margin:0;
      padding:0;
      padding-left: 0.5em;
    }
    .canvas {
      margin-left: auto;
      margin-right: auto;
      font-size: 3em;
      user-select: none;
    }
    .settings {
      margin-left: auto;
      margin-right: auto;
      width: 30%;
      padding: 2%;
      border-radius: 5px;
      background-color: #313338;
      text-align: center;
    }
    .settings input{
      padding: 1em;
      text-align: center;
      border-radius: 10px;
      font-size: 1.2em;
      margin-bottom:1em;
    }
    .settings input[type="button"]{
      color:#DDD;
      background-color: #202227;
    }
    .settings input[type="button"]:active{
      background-color: #313338;
    }
    .settings input[type="number"]{
      width:3em;
    }
    .settings #linker {
      color:#DDD;
    }
    .settings #linker .material-symbols-outlined{
      position:relative;
      top:0.3em;
    }
    .settings .picker_container {
      display: inline-block;
    }
    .settings .picker_container .picker_button {
      position:relative;
      top:0.15em;
      font-size: 2em;
      text-decoration: none;
      background-color: #424449;
      padding-left: 0.1em;
      padding-right: 0.1em;
      border-radius: 0.5em;
      color:#DDD;
    }
    .settings .picker_container .picker {
      display: none;
      z-index: 1;
      border-radius: 0.5em;
      padding: 1em;
      font-size: 2em;
    }
    .settings .picker_container .picker a{
      padding: 0.5em;
      text-decoration: none;
    }
    .settings a:active .picker {
      display: block;
      position: absolute;
      background-color: #424449;
    }
    .settings .picker_container:hover .picker {
      display: block;
      position: absolute;
      background-color: #424449;
    }
    
    </style>
</head>

<body>
<h1>❤️🎨</h1>
  <table id="canvas" class="canvas"></table>
  <div class="settings">
    <br>
    <input type="number" value="11" min=1 id="width"></input>
    <b><a href="#" id="linker"><span class="material-symbols-outlined">
link
</span></a></b>
    <input type="number" value="6" min=1 id="height"></input>
    &nbsp;&nbsp;&nbsp;
    <div class="picker_container">
      <a href="#" id="colorone" class="picker_button"><span class="material-symbols-outlined">stylus_note</span>❤️</a>
      <div class="picker" id="colorone_picker">
        <a href="#" onclick=setColor()>❤️</a><a href="#" onclick=setColor>🧡</a><a href="#" onclick=setColor>💛</a><a href="#" onclick=setColor>💚</a><a href="#" onclick=setColor>💙</a><a href="#" onclick=setColor>💜</a><a href="#" onclick=setColor>🤎</a><a href="#" onclick=setColor>🖤</a><a href="#" onclick=setColor>🤍</a><a href="#" onclick=setColor>🩶</a><a href="#" onclick=setColor>🩷</a><a href="#" onclick=setColor>🩵</a>
      </div>
    </div>
    &nbsp;
    <div class="picker_container">
      <a href="#" id="colortwo" class="picker_button"><span class="material-symbols-outlined">ink_eraser</span>🖤</a>
      <div class="picker" id="colortwo_picker">
        <a href="#" onclick=setColor()>❤️</a><a href="#" onclick=setColor>🧡</a><a href="#" onclick=setColor>💛</a><a href="#" onclick=setColor>💚</a><a href="#" onclick=setColor>💙</a><a href="#" onclick=setColor>💜</a><a href="#" onclick=setColor>🤎</a><a href="#" onclick=setColor>🖤</a><a href="#" onclick=setColor>🤍</a><a href="#" onclick=setColor>🩶</a><a href="#" onclick=setColor>🩷</a><a href="#" onclick=setColor>🩵</a>
      </div>
    </div>
    <br>
    <input type="button" value="COPY" onclick=copy()></input>
  </div>
</body>
<script>

/*
TODO
- Colour Picker
- Copy
- Touch support (optimistic)
- Responsive
- Dump on Github
- custom domain? .art domains are cheap right now.

*/

/*hearts = {
  "red":"❤️",
  "pink":"🩷",
  "orange":"🧡",
  "yellow":"💛",
  "green":"💚",
  "blue":"💙",
  "light_blue":"🩵",
  "purple":"💜",
  "brown":"🤎",
  "black":"🖤",
  "white":"🤍",
  "grey":"🩶"
}*/


hearts = ["❤️","🩷","🧡","💛","💚","💙","🩵","💜","🤎","🖤","🤍","🩶"]

coloredHearts = []

selecting = false;
document.addEventListener("mousedown", function(){
  selecting = true;
})
document.addEventListener("mouseup", function(){
  selecting = false;
  coloredHearts = []
  activeColour = ""
})


const CANVAS = document.getElementById("canvas")

const LINKER = document.getElementById("linker")
LINKER.addEventListener("click", toggleLink)
linked = false;

const WIDTHSELECTOR = document.getElementById("width")
const HEIGHTSELECTOR = document.getElementById("height")
WIDTHSELECTOR.addEventListener("change", function(){
  checkLinked(WIDTHSELECTOR.value)
  setCanvasSize(WIDTHSELECTOR.value, HEIGHTSELECTOR.value)
})
HEIGHTSELECTOR.addEventListener("change", function(){
  checkLinked(HEIGHTSELECTOR.value)
  setCanvasSize(WIDTHSELECTOR.value, HEIGHTSELECTOR.value)
})

const COLORONE = document.getElementById("colorone")
const COLORTWO = document.getElementById("colortwo")
const COLORONE_PICKER = document.getElementById("colorone_picker")
const COLORTWO_PICKER = document.getElementById("colortwo_picker")
for (child of COLORONE_PICKER.children){
  child.addEventListener("click", setColorOne)
}
for (child of COLORTWO_PICKER.children){
  child.addEventListener("click", setColorTwo)
}
colorOne = "❤️"
colorTwo = "🖤"
activeColour = ""

function setLinkedStatus(){
  icon = LINKER.firstChild.cloneNode(true)
  if (linked){
    icon.innerHTML = "link"
  }
  else {
    icon.innerHTML = "link_off"
  }
  LINKER.replaceChild(icon, LINKER.childNodes[0])
}

function toggleLink(){
  linked = !linked
  setLinkedStatus();
}

function checkLinked(value){
  if (linked){
    WIDTHSELECTOR.value = value
    HEIGHTSELECTOR.value = value
  }
}

function makeNewRow(width){
  row = document.createElement("tr")
  for (i = 0; i <= width; i ++){
    row.appendChild(makeNewHeart())
  }
  return row
}

function setColorOne(e){
  colorOne = e.target.innerHTML
  COLORONE.innerHTML = "<span class=\"material-symbols-outlined\">stylus_note</span>"+colorOne
}

function setColorTwo(e){
  colorTwo = e.target.innerHTML
  COLORTWO.innerHTML = "<span class=\"material-symbols-outlined\">ink_eraser</span>"+colorTwo
}

function setCanvasSize(width, height){
  while (CANVAS.children.length > height){
    CANVAS.removeChild(CANVAS.lastChild)
  }
  while (CANVAS.children.length < height){
    CANVAS.appendChild(makeNewRow(width))
  }
  for (child of CANVAS.children){
    while (child.children.length > width){
      child.removeChild(child.lastChild)
    }
    while (child.children.length < width){
      child.appendChild(makeNewHeart())
    }
  }
}

function toggleheart(heart){
  if (activeColour == ""){
    if (heart.innerHTML == colorTwo){
      activeColour = colorOne
    }
    else {
      activeColour = colorTwo
    }
  }
  if (!coloredHearts.includes(heart)){
    coloredHearts.push(heart)
    heart.innerHTML = activeColour
  }
}

function heartentry(e){
  if (selecting == true){
    toggleheart(e.target)
  }
}

function makeNewHeart(){
  td = document.createElement("td")
  td.innerHTML = colorTwo
  td.addEventListener("mousedown", function(e){toggleheart(e.target)})
  td.addEventListener("mouseenter", heartentry)
  return td
}

async function copy(){
  text = ""
  for (child of CANVAS.children){
    for (heart of child.children){
      text = text+heart.innerHTML
    }
    text = text+"\n"
  }
  try {
    await navigator.clipboard.writeText(text);
  } catch (error) {
    console.error(error.message);
  }
}

function setup(){
  setLinkedStatus()
  checkLinked(6)
  setCanvasSize(WIDTHSELECTOR.value, HEIGHTSELECTOR.value) 
}
setup()
</script>
</html>
